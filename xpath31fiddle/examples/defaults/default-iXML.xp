let $jwiXML := js:jwiXML(),
    $compileGrammar := function($grammarSource) { ixsl:call($jwiXML, 'compile', [$grammarSource]) },
    $parseIXML := function($grammar, $input) { ixsl:call($grammar, 'parse', [$input, map {'justOne': false()}]) },
    $grammar1 := $compileGrammar(//code[@id = 'grammar1']/string())
return
    $parseIXML($grammar1, //code[@id = 'data']/string())?tree