<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Inserting script elements generated by XSLTProcessor transformToFragment</title>
<script>
function loadAndRunXslt(xmlUrl, xsltUrl, targetElement) {
  var docs = { xml: null, xslt: null };
  var req1 = new XMLHttpRequest();
  req1.open('GET', xmlUrl);
  req1.onload = function() {
    docs.xml = this.responseXML;
    if (docs.xslt != null) {
      runXslt(docs.xml, docs.xslt, targetElement);
    }
  };
  req1.send();
  var req2 = new XMLHttpRequest();
  req2.open('GET', xsltUrl);
  req2.onload = function() {
    docs.xslt = this.responseXML;
    if (docs.xslt != null) {
      runXslt(docs.xml, docs.xslt, targetElement);
    }
  };
  req2.send();
}

function runXslt(xmlDoc, xsltDoc, targetElement) {
  var proc = new XSLTProcessor();
  proc.importStylesheet(xsltDoc);
  targetElement.appendChild(targetElement.ownerDocument.importNode(proc.transformToFragment(xmlDoc, targetElement.ownerDocument), true));
}

function log(text) {
  var p = document.createElement('p');
  p.textContent = new Date() + ': ' + text;
  document.body.appendChild(p);
  console.log(text);
}
</script>
<script>
window.onload = function() {
  loadAndRunXslt('test2015111601.xml', 'test2015111605.xsl', document.getElementById('s1'));
};
</script>
</head>
  <body>
    <h1>Inserting script elements generated by XSLTProcessor transformToFragment</h1>
    <section id="s1">
      <h2>XSLT result elements should be added here</h2>
    </section>
</body>
</html>